# 마이크로 프로그램된 제어

> 본 글은 아래 강의를 바탕으로 작성되었습니다.
>
> [CSA2021 컴퓨터시스템구조 제 7 장 Part-1](https://youtu.be/nhJ1prbfmuE)
>
> [CSA2021 컴퓨터시스템구조 제 7 장 Part-2](https://youtu.be/lBNXUYRcDHc)

<br>

## 목차

[1. 제어 메모리](#1-제어-메모리)

[2. 주소 시퀀싱](#2-주소-시퀀싱)

[3. 마이크로프로그램의 예](#3-마이크로프로그램의-예)

[4. 제어 장치의 설계](#4-제어-장치의-설계)

<br>

## 1. 제어 메모리

### 하드와이어 제어 장치

하드와이어 제어 장치는 하드웨어적으로 제어 장치를 설계한 것으로 일상적인 논리회로를 사용하여 구현한다.

### 제어 워드

버스 구조 시스템에서 정보 전달 제어 비트의 모임을 제어 워드라 하며 제어 워드에 의하여 마이크로 연산을 수행한다.

### 마이크로프로그램

마이크로프로그램은 명령을 수행하는 일련의 제어 워드의 집합이며 별도의 기억장치에 저장된 프로그램의 형태이다.

### 마이크로프로그램된 제어 장치

마이크로프로그램된 제어 장치는 ROM을 이용해 저장하며 시퀀서(다음 T에 수행할 명령어를 담음)와 제어 메모리로 구성된다.

<br>

## 2. 주소 시퀀싱

### 초기 주소

초기 주소는 시스템 부트시 jump 하는 주소이다. ROM BIOS 주소를 나타내며 하드웨어적으로 미리 결정된 주소이다. IBM PC의 경우 이는 0xFFFE0(20bit XT) 이다.

### 제어 메모리 주소 시퀀싱 단계

1. 명령어 fetch
2. 유효 주소(Effective Address) 계산
3. 마이크로연산 수행을 위한 제어 워드 fetch
4. 명령어 실행

### 다음 제어 메모리의 주소를 결정하는 방법

- Branch by condition
- Mapping from Opcode
- Subroutine call/return
- Increment

### 조건부 분기

- 상태비트(IU, I, S, Z)에 따른 분기

### 명령어의 매칭

- Opcode로부터 제어 워드 주소 분기
- 제어 메모리 크기(비트 수)에 맞는 매핑 논리 사용
- 명령어에 사용되는 제어 워드 수에 따라서 매핑
- 매핑 비트의 결정
  - 제어메모리  크기: 128 -> 7bit
  - 명령어가 가지는 제어 워드 최대 크기가 3인 경우 2비트 간격으로 제어 메모리 배치

### 서브루틴

- 동일한 제어 코드들을 서브루틴화
- Fetch 제어, 간접 주소 계산 등
- SBR에 복귀 제어메모리 주소 저장

<br>

## 3. 마이크로프로그램의 예

### 마이크로프로그램 제어를 위한 하드웨어 구성

- 128 x 20 제어 메모리 사용
  - 128개의 제어 워드 사용
  - 20bit의 제어 워드로 구성

### 컴퓨터 명령어 형식

### 마이크로 명령어 형식

### 기호로 표시된 마이크로 명령어

- Fetch 루틴
- Indirect 루틴

### 이진 마이크로프로그램

<br>

## 4. 제어 장치의 설계

### 마이크로 연산 필드의 디코딩 회로

### 마이크로프로그램 시퀀서의 설계

- Input logic 설계